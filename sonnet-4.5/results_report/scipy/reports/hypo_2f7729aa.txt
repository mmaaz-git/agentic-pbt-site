Traceback (most recent call last):
  File "/home/npc/pbt/agentic-pbt/worker_/57/hypo.py", line 28, in test_kmeans2_cholesky_crash_on_degenerate_data
    codebook, labels = kmeans2(obs_degenerate, k, iter=1, minit='random')
                       ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/npc/.local/lib/python3.13/site-packages/scipy/_lib/_util.py", line 352, in wrapper
    return fun(*args, **kwargs)
  File "/home/npc/.local/lib/python3.13/site-packages/scipy/cluster/vq.py", line 817, in kmeans2
    code_book = init_meth(data, code_book, rng, xp)
  File "/home/npc/.local/lib/python3.13/site-packages/scipy/cluster/vq.py", line 571, in _krandinit
    x = x @ xp.linalg.cholesky(_cov).T
            ~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/npc/.local/lib/python3.13/site-packages/scipy/_lib/array_api_compat/_internal.py", line 34, in wrapped_f
    return f(*args, xp=xp, **kwargs)
  File "/home/npc/.local/lib/python3.13/site-packages/scipy/_lib/array_api_compat/common/_linalg.py", line 89, in cholesky
    L = xp.linalg.cholesky(x, **kwargs)
  File "/home/npc/miniconda/lib/python3.13/site-packages/numpy/linalg/_linalg.py", line 897, in cholesky
    r = gufunc(a, signature=signature)
  File "/home/npc/miniconda/lib/python3.13/site-packages/numpy/linalg/_linalg.py", line 166, in _raise_linalgerror_nonposdef
    raise LinAlgError("Matrix is not positive definite")
numpy.linalg.LinAlgError: Matrix is not positive definite

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/npc/pbt/agentic-pbt/worker_/57/hypo.py", line 36, in <module>
    test_kmeans2_cholesky_crash_on_degenerate_data()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/npc/pbt/agentic-pbt/worker_/57/hypo.py", line 19, in test_kmeans2_cholesky_crash_on_degenerate_data
    k=st.integers(min_value=1, max_value=10))
            ^^^
  File "/home/npc/miniconda/lib/python3.13/site-packages/hypothesis/core.py", line 2124, in wrapped_test
    raise the_error_hypothesis_found
  File "/home/npc/pbt/agentic-pbt/worker_/57/hypo.py", line 32, in test_kmeans2_cholesky_crash_on_degenerate_data
    pytest.fail(f"kmeans2 with minit='random' crashes on rank-deficient data: {e}")
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/npc/miniconda/lib/python3.13/site-packages/_pytest/outcomes.py", line 177, in fail
    raise Failed(msg=reason, pytrace=pytrace)
Failed: kmeans2 with minit='random' crashes on rank-deficient data: Matrix is not positive definite
Falsifying example: test_kmeans2_cholesky_crash_on_degenerate_data(
    # The test always failed when commented parts were varied together.
    obs=array(
        [[0.0, 0.0, 0.0],
         [0.0, 0.0, 0.0],
         [0.0, 0.0, 0.0],
         [0.0, 0.0, 0.0],
         [0.0, 0.0, 0.0],
         [0.0, 0.0, 0.0],
         [0.0, 0.0, 0.0],
         [0.0, 0.0, 0.0],
         [0.0, 0.0, 0.0],
         [0.0, 0.0, 0.0]],
    ),  # or any other generated value
    k=1,  # or any other generated value
)
