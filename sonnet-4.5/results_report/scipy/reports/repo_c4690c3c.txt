/home/npc/.local/lib/python3.13/site-packages/scipy/signal/windows/_windows.py:946: RuntimeWarning: overflow encountered in divide
  w3 = 0.5 * (1 + xp.cos(xp.pi * (-2.0/alpha + 1 + 2.0*n3/alpha/(M-1))))
/home/npc/.local/lib/python3.13/site-packages/scipy/signal/windows/_windows.py:946: RuntimeWarning: invalid value encountered in add
  w3 = 0.5 * (1 + xp.cos(xp.pi * (-2.0/alpha + 1 + 2.0*n3/alpha/(M-1))))
Testing tukey function with tiny alpha values:
--------------------------------------------------
tukey(2, alpha=1e-309) = [ 0. nan]
Contains NaN: True

tukey(10, alpha=1e-309) = [ 0.  1.  1.  1.  1.  1.  1.  1.  1. nan]
Contains NaN: True

tukey(2, alpha=1e-320) = [ 0. nan]
Contains NaN: True

Finding the boundary where NaN appears:
--------------------------------------------------
alpha=1.000000e-50: Contains NaN = False
alpha=1.000000e-100: Contains NaN = False
alpha=1.000000e-200: Contains NaN = False
alpha=1.000000e-300: Contains NaN = False
alpha=1.000000e-305: Contains NaN = False
alpha=1.000000e-308: Contains NaN = True
alpha=1.000000e-309: Contains NaN = True
alpha=1.000000e-310: Contains NaN = True
alpha=9.999889e-321: Contains NaN = True
