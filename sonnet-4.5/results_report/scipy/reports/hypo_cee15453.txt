============================= test session starts ==============================
platform linux -- Python 3.13.2, pytest-8.4.1, pluggy-1.5.0 -- /home/npc/miniconda/bin/python3
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: /home/npc/pbt/agentic-pbt/worker_/24
plugins: anyio-4.9.0, hypothesis-6.139.1, asyncio-1.2.0, langsmith-0.4.29
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 1 item

hypo.py::test_date_format_without_year_shouldnt_set_year_unit FAILED     [100%]

=================================== FAILURES ===================================
_____________ test_date_format_without_year_shouldnt_set_year_unit _____________

    @given(st.text(alphabet='MdHms-/: ', min_size=1, max_size=50))
>   def test_date_format_without_year_shouldnt_set_year_unit(pattern_body):
                   ^^^

hypo.py:6: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

pattern_body = 'H'

    @given(st.text(alphabet='MdHms-/: ', min_size=1, max_size=50))
    def test_date_format_without_year_shouldnt_set_year_unit(pattern_body):
        """
        Test that date patterns without year components don't incorrectly
        set datetime_unit to 'Y' during processing.
    
        This test exposes a bug where 'elif "yy":' (always True) causes
        datetime_unit to be incorrectly set to 'Y' for patterns without years.
        """
        assume('y' not in pattern_body.lower())
        assume(any(x in pattern_body for x in ['M', 'd', 'H', 'm', 's']))
    
        pattern_str = f"date {pattern_body}"
    
        try:
            date_fmt, datetime_unit = DateAttribute._get_date_format(pattern_str)
>           assert datetime_unit != "Y", \
                f"Pattern {pattern_body} has no year but datetime_unit is 'Y'"
E               AssertionError: Pattern H has no year but datetime_unit is 'Y'
E               assert 'Y' != 'Y'
E               Falsifying example: test_date_format_without_year_shouldnt_set_year_unit(
E                   pattern_body='H',
E               )

hypo.py:21: AssertionError
=========================== short test summary info ============================
FAILED hypo.py::test_date_format_without_year_shouldnt_set_year_unit - Assert...
============================== 1 failed in 0.22s ===============================
