============================= test session starts ==============================
platform linux -- Python 3.13.2, pytest-8.4.1, pluggy-1.5.0 -- /home/npc/miniconda/bin/python3
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: /home/npc/pbt/agentic-pbt/worker_/3
plugins: anyio-4.9.0, hypothesis-6.139.1, asyncio-1.2.0, langsmith-0.4.29
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 1 item

hypo.py::test_derivative_should_reject_zero_step_factor FAILED           [100%]

=================================== FAILURES ===================================
________________ test_derivative_should_reject_zero_step_factor ________________

    @given(st.just(0.0))
>   def test_derivative_should_reject_zero_step_factor(step_factor):
                   ^^^

hypo.py:7: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

step_factor = 0.0

    @given(st.just(0.0))
    def test_derivative_should_reject_zero_step_factor(step_factor):
        """Test that derivative function should reject step_factor=0 with a ValueError"""
>       with pytest.raises(ValueError, match="step_factor"):
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       Failed: DID NOT RAISE <class 'ValueError'>
E       Falsifying example: test_derivative_should_reject_zero_step_factor(
E           step_factor=0.0,
E       )

hypo.py:9: Failed
=============================== warnings summary ===============================
hypo.py::test_derivative_should_reject_zero_step_factor
hypo.py::test_derivative_should_reject_zero_step_factor
  /home/npc/.local/lib/python3.13/site-packages/scipy/differentiate/_differentiate.py:468: RuntimeWarning: divide by zero encountered in divide
    hc = h / c**xp.arange(n, dtype=work.dtype)

hypo.py::test_derivative_should_reject_zero_step_factor
hypo.py::test_derivative_should_reject_zero_step_factor
  /home/npc/.local/lib/python3.13/site-packages/scipy/differentiate/_differentiate.py:474: RuntimeWarning: divide by zero encountered in divide
    hr = h / d**xp.arange(2*n, dtype=work.dtype)

hypo.py::test_derivative_should_reject_zero_step_factor
hypo.py::test_derivative_should_reject_zero_step_factor
  /home/npc/.local/lib/python3.13/site-packages/scipy/_lib/_elementwise_iterative_method.py:243: RuntimeWarning: invalid value encountered in sin
    f = func(x, *work.args)

hypo.py::test_derivative_should_reject_zero_step_factor
hypo.py::test_derivative_should_reject_zero_step_factor
  /home/npc/.local/lib/python3.13/site-packages/scipy/differentiate/_differentiate.py:678: RuntimeWarning: divide by zero encountered in power
    h = s / fac ** p

hypo.py::test_derivative_should_reject_zero_step_factor
hypo.py::test_derivative_should_reject_zero_step_factor
  /home/npc/.local/lib/python3.13/site-packages/scipy/differentiate/_differentiate.py:678: RuntimeWarning: divide by zero encountered in divide
    h = s / fac ** p

hypo.py::test_derivative_should_reject_zero_step_factor
hypo.py::test_derivative_should_reject_zero_step_factor
  /home/npc/.local/lib/python3.13/site-packages/scipy/differentiate/_differentiate.py:700: RuntimeWarning: divide by zero encountered in power
    h = s / np.sqrt(fac) ** p

hypo.py::test_derivative_should_reject_zero_step_factor
hypo.py::test_derivative_should_reject_zero_step_factor
  /home/npc/.local/lib/python3.13/site-packages/scipy/differentiate/_differentiate.py:700: RuntimeWarning: divide by zero encountered in divide
    h = s / np.sqrt(fac) ** p

hypo.py::test_derivative_should_reject_zero_step_factor
hypo.py::test_derivative_should_reject_zero_step_factor
  /home/npc/.local/lib/python3.13/site-packages/scipy/differentiate/_differentiate.py:542: RuntimeWarning: divide by zero encountered in divide
    work.h /= work.fac

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED hypo.py::test_derivative_should_reject_zero_step_factor - Failed: DID ...
======================== 1 failed, 16 warnings in 0.25s ========================
