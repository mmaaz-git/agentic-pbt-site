/home/npc/miniconda/lib/python3.13/site-packages/xarray/plot/utils.py:778: RuntimeWarning: invalid value encountered in divide
  darray = ((darray.astype("f8") - vmin) / (vmax - vmin)).astype("f4")
/home/npc/miniconda/lib/python3.13/site-packages/xarray/plot/utils.py:778: RuntimeWarning: divide by zero encountered in divide
  darray = ((darray.astype("f8") - vmin) / (vmax - vmin)).astype("f4")
Test 1: Single constant value [0.0]
Input: [0.]
Result: [nan]
Contains NaN: True

Test 2: Multiple identical values [5.0, 5.0, 5.0]
Input: [5. 5. 5.]
Result: [nan nan nan]
Contains NaN: True

Test 3: Explicitly set vmin=vmax with [1.0, 2.0, 3.0]
Input: [1. 2. 3.]
Result: [ 0. nan  1.]
Contains NaN: True
