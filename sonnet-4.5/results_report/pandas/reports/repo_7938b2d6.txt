Original DataFrame:
   cat
0    a
1    b
2  NaN
3    a
Original categorical codes: [0, 1, -1, 0]

Result DataFrame:
  cat
0   a
1   b
2   c
3   a
Result categorical codes: [0, 1, 2, 0]

Original nulls: [False, False, True, False]
Result nulls: [False, False, False, False]
