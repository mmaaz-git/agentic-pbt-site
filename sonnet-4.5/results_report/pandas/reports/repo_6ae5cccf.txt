With explicit all-False mask: dtype=float64
With mask=None: dtype=int32
Traceback (most recent call last):
  File "/home/npc/pbt/agentic-pbt/worker_/1/repo.py", line 14, in <module>
    assert result_with_mask.dtype == result_without_mask.dtype, \
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Inconsistent dtypes: float64 vs int32
