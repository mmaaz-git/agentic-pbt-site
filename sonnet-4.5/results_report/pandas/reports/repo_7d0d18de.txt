=== Testing numpy.char.replace() truncation bug ===

replace('a', 'a', 'aa')
  numpy result:  'a'
  python result: 'aa'
  numpy dtype:   <U1
  ❌ MISMATCH - Data truncated!

replace('hello', 'hello', 'hello world')
  numpy result:  'hello'
  python result: 'hello world'
  numpy dtype:   <U5
  ❌ MISMATCH - Data truncated!

replace('test', 'test', 'testing')
  numpy result:  'test'
  python result: 'testing'
  numpy dtype:   <U4
  ❌ MISMATCH - Data truncated!

replace('Dr', 'Dr', 'Doctor')
  numpy result:  'Do'
  python result: 'Doctor'
  numpy dtype:   <U2
  ❌ MISMATCH - Data truncated!

replace('foo', 'o', 'oo')
  numpy result:  'foooo'
  python result: 'foooo'
  numpy dtype:   <U5
  ✓ Match

replace('x', 'x', 'xyz')
  numpy result:  'x'
  python result: 'xyz'
  numpy dtype:   <U1
  ❌ MISMATCH - Data truncated!


=== Demonstrating the root cause ===

The issue is that numpy.char.replace preserves the original dtype:

Input dtype: <U1, value: 'a'
Output dtype: <U1, value: 'a'
Expected: 'aa', Got: 'a', Correct: False

Input dtype: <U2, value: 'a'
Output dtype: <U2, value: 'aa'
Expected: 'aa', Got: 'aa', Correct: True

Input dtype: <U5, value: 'a'
Output dtype: <U2, value: 'aa'
Expected: 'aa', Got: 'aa', Correct: True

