Test Case 1: Primary Bug Scenario
==================================================
cat_a: values=['a'], categories=['a']
cat_b: values=['a', 'b\x00'], categories=['a', 'b\x00']
cat_c: values=['b'], categories=['b']

Expected categories: ['a', 'b\x00', 'b']
Actual categories: ['a', 'b\x00']
Expected values: ['a', 'a', 'b\x00', 'b']
Actual values: ['a', 'a', 'b\x00', nan]


Test Case 2: Hypothesis Failing Input
==================================================
cat1: values=['0'], categories=['0']
cat2: values=['0', '1\x00'], categories=['0', '1\x00']
cat3: values=['1'], categories=['1']

Expected categories: ['0', '1\x00', '1']
Actual categories: ['0', '1\x00']
Expected values: ['0', '0', '1\x00', '1']
Actual values: ['0', '0', '1\x00', nan]


Test Case 3: Two Categoricals Only
==================================================
Combining only cat_b and cat_c:
Expected categories: ['a', 'b\x00', 'b']
Actual categories: ['a', 'b\x00', 'b']
Expected values: ['a', 'b\x00', 'b']
Actual values: ['a', 'b\x00', 'b']


Test Case 4: Different Order
==================================================
Combining in reverse order [cat_c, cat_b, cat_a]:
Expected categories: ['b', 'a', 'b\x00'] (or all three)
Actual categories: ['b', 'a']
Expected values: ['b', 'a', 'b\x00', 'a']
Actual values: ['b', 'a', nan, 'a']
