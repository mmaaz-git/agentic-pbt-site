Running Hypothesis property-based test for forbid_multi_line_headers
============================================================

Testing property: forbid_multi_line_headers should NEVER return
values containing newlines (its purpose is to prevent header injection)


❌ VULNERABILITY FOUND!
  Input: name='X-Custom-Header', val='0\x0c\x80', encoding='utf-8'
  Output: '=?utf-8?q?0?=\n =?utf-8?b?IMKA?='
  The output contains newline (\n)

  This violates the function's security guarantee!
Unexpected error: Output contains newline despite clean input: '=?utf-8?q?0?=\n =?utf-8?b?IMKA?='
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.

❌ VULNERABILITY FOUND!
  Input: name='\U000443bdIVk\U000721c9ñ', val='\x1e\x94\x05\x0cî', encoding='ascii'
  Output: ' =?utf-8?b?IMKUBQ==?=\n =?utf-8?b?IMOu?='
  The output contains newline (\n)

  This violates the function's security guarantee!
Unexpected error: Output contains newline despite clean input: ' =?utf-8?b?IMKUBQ==?=\n =?utf-8?b?IMOu?='
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.

❌ VULNERABILITY FOUND!
  Input: name='', val='0\x0c\x80', encoding='iso-8859-1'
  Output: '=?iso-8859-1?q?0?=\n =?iso-8859-1?q?_=80?='
  The output contains newline (\n)

  This violates the function's security guarantee!
Unexpected error: Output contains newline despite clean input: '=?iso-8859-1?q?0?=\n =?iso-8859-1?q?_=80?='

❌ VULNERABILITY FOUND!
  Input: name='0\x0c\x80', val='0\x0c\x80', encoding='iso-8859-1'
  Output: '=?iso-8859-1?q?0?=\n =?iso-8859-1?q?_=80?='
  The output contains newline (\n)

  This violates the function's security guarantee!
Unexpected error: Output contains newline despite clean input: '=?iso-8859-1?q?0?=\n =?iso-8859-1?q?_=80?='
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
Unexpected error: Requested setting DEFAULT_CHARSET, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.
✓ All property tests passed!

No vulnerabilities detected in the tested inputs.
