from hypothesis import given, strategies as st
from django.core.checks.registry import CheckRegistry


@given(st.text(min_size=1))
def test_registry_check_returns_string_bug(error_string):
    registry = CheckRegistry()

    def bad_check(app_configs, **kwargs):
        return error_string

    registry.register(bad_check, "test")

    result = registry.run_checks()

    assert len(result) == len(error_string)
    assert result == list(error_string)


if __name__ == "__main__":
    # Run the property-based test
    import traceback

    try:
        test_registry_check_returns_string_bug()
        print("Test passed for multiple string inputs generated by Hypothesis")
        print("\nExample with 'error message':")

        # Show specific example
        registry = CheckRegistry()
        def bad_check(app_configs, **kwargs):
            return "error message"
        registry.register(bad_check, "test")
        result = registry.run_checks()
        print(f"Input string: 'error message'")
        print(f"Result: {result}")
        print(f"This demonstrates that strings are incorrectly split character-by-character")
    except Exception as e:
        print(f"Test failed with error: {e}")
        traceback.print_exc()