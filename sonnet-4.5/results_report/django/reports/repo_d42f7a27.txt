============================================================
REPRODUCING HEADER INJECTION VULNERABILITY
============================================================

Function: forbid_multi_line_headers
Purpose: 'Forbid multi-line headers to prevent header injection'

INPUT:
  name: 'X-Custom-Header'
  val: '0\x0c\x80'
  encoding: 'utf-8'

OUTPUT:
  result_name: 'X-Custom-Header'
  result_val: '=?utf-8?q?0?=\n =?utf-8?b?IMKA?='

ANALYSIS:
  Contains \n (newline): True
  Contains \r (carriage return): False

‚ùå VULNERABILITY CONFIRMED!
The function returned a value with newlines, violating its
documented purpose of preventing header injection.

SECURITY IMPACT:
  - This allows header injection attacks
  - Attackers can inject additional email headers
  - Could lead to email spoofing and phishing

DETAILED OUTPUT BREAKDOWN:
  Raw bytes: b'=?utf-8?q?0?=\n =?utf-8?b?IMKA?='
  Character breakdown:
    [0]: '='
    [1]: '?'
    [2]: 'u'
    [3]: 't'
    [4]: 'f'
    [5]: '-'
    [6]: '8'
    [7]: '?'
    [8]: 'q'
    [9]: '?'
    [10]: '0'
    [11]: '?'
    [12]: '='
    [13]: '\n' (NEWLINE - SECURITY ISSUE)
    [14]: ' '
    [15]: '='
    [16]: '?'
    [17]: 'u'
    [18]: 't'
    [19]: 'f'
    [20]: '-'
    [21]: '8'
    [22]: '?'
    [23]: 'b'
    [24]: '?'
    [25]: 'I'
    [26]: 'M'
    [27]: 'K'
    [28]: 'A'
    [29]: '?'
    [30]: '='
