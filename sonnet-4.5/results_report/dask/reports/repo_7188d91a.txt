Test 1: Basic case
Sequence: [1, 2, 3, 4]
Requested npartitions: 3
Actual npartitions: 2
Expected: 3, Got: 2

Test 2: Specific failing case
Sequence: [0, 0, 0, 0, 0]
Requested npartitions: 4
Actual npartitions: 3
Expected: 4, Got: 3

Test 3: Downstream zip() problem
bag1 ([0, 0, 0], npartitions=3): 3 partitions
bag2 ([0, 0, 0, 0], npartitions=3): 2 partitions
zip() failed with AssertionError: 
Traceback (most recent call last):
  File "/home/npc/pbt/agentic-pbt/worker_/59/repo.py", line 43, in <module>
    assert bag.npartitions == requested_npartitions, f"Expected {requested_npartitions} partitions, got {bag.npartitions}"
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Expected 3 partitions, got 2
