DOCUMENTATION ANALYSIS FOR CSRF_TRUSTED_ORIGINS

Based on my review of the Django documentation and release notes, here are the key findings:

1. Django 4.0 Release Notes:
   - Django 4.0 explicitly requires that CSRF_TRUSTED_ORIGINS values include the scheme
   - The release notes state: "Values must now include the scheme (e.g., 'http://' or 'https://')"
   - A system check was added to detect required changes for this new requirement
   - The documentation specifically mentions this is part of enhanced CSRF protection

2. Django Settings Documentation:
   - CSRF_TRUSTED_ORIGINS should contain a list of trusted origins for unsafe requests
   - Origins should include the full scheme and domain
   - Example formats show 'https://subdomain.example.com' and 'https://*.example.com'
   - The documentation emphasizes schemes should be 'https://' or 'http://'

3. Error Message in Code:
   - The error message in check_csrf_trusted_origins states: "As of Django 4.0, the values in the CSRF_TRUSTED_ORIGINS setting must start with a scheme (usually http:// or https://)"
   - The phrase "usually http:// or https://" suggests these are the expected schemes but doesn't explicitly limit to only these

4. Middleware Usage:
   - The middleware code uses urlsplit() to parse origins
   - It extracts scheme and netloc from the parsed URL
   - The middleware maintains separate collections for exact matches and subdomain patterns
   - No explicit validation of scheme types in the middleware itself

5. What the Documentation Does NOT Specify:
   - The documentation does not explicitly enumerate ALL valid schemes
   - It does not specifically state that only 'http' and 'https' are allowed
   - It does not mention whether WebSocket schemes (ws/wss) are valid
   - It does not mention whether other schemes like 'ftp' are valid or invalid

The documentation focuses on the requirement that schemes must be present as of Django 4.0, with strong suggestions that http:// and https:// are the primary expected schemes, but without explicitly limiting the set of allowed schemes.