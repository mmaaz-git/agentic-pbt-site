REPRODUCTION ANALYSIS
=====================

Bug Reproduction Status: CONFIRMED

The bug report correctly identifies a ZeroDivisionError in xarray.core.indexes.PandasIndex.roll() when called on empty indexes.

Hypothesis Test Results:
- The provided Hypothesis test successfully identifies the bug
- Out of 200 test examples, every empty index (length 0) with any shift value causes a ZeroDivisionError
- Non-empty indexes work correctly
- The error occurs on line 914 of indexes.py: `shift = shifts[self.dim] % self.index.shape[0]`

Minimal Reproduction:
- The minimal example provided in the bug report correctly reproduces the issue
- Creating a PandasIndex with an empty pd.Index([]) and calling roll() with any shift value triggers the error
- The error message matches exactly: "ZeroDivisionError: integer modulo by zero"

Stack Trace Analysis:
The crash occurs at:
  File "/home/npc/miniconda/lib/python3.13/site-packages/xarray/core/indexes.py", line 914, in roll
    shift = shifts[self.dim] % self.index.shape[0]

Root Cause:
The code performs modulo operation (%) with self.index.shape[0] as the divisor without checking if it's zero. When the index is empty, shape[0] is 0, causing division by zero.

Expected Behavior (based on numpy and pandas conventions):
- NumPy's np.roll() handles empty arrays correctly, returning an empty array
- The logical behavior for rolling an empty index is to return an unchanged empty index
- This is a valid operation that should not crash