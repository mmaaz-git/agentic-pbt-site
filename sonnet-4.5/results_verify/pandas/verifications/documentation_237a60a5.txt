DOCUMENTATION ANALYSIS
======================

1. Function Purpose (from docstring):
   - "Quantile-based discretization function"
   - "Discretize variable into equal-sized buckets based on rank or based on sample quantiles"
   - Key phrase: "equal-sized buckets"

2. Parameter Documentation for 'duplicates':
   - Description: "If bin edges are not unique, raise ValueError or drop non-uniques"
   - Options: 'raise' (default) or 'drop'
   - Documentation does NOT specify what happens to bucket sizes when 'drop' is used
   - No warning about potential uneven distribution when using 'drop'

3. What the Documentation Promises:
   - The main description explicitly states "equal-sized buckets"
   - Example given: "1000 values for 10 quantiles would produce a Categorical object
     indicating quantile membership for each data point"
   - This implies each quantile should contain approximately 100 values

4. Documentation Gaps:
   - No mention that duplicates='drop' can violate the "equal-sized" property
   - No warning that merging bins due to duplicate edges creates uneven distributions
   - No examples showing the behavior with duplicates='drop'
   - The documentation for 'duplicates' parameter only describes the mechanical action
     (drop non-uniques) but not the consequence (uneven bucket sizes)

5. Source Code Behavior:
   - When duplicates='drop', the code simply removes duplicate bin edges
   - No attempt to rebalance or redistribute values after dropping duplicates
   - This is a straightforward implementation that doesn't preserve equal sizes

6. User Expectations vs Reality:
   - Users expect: "equal-sized buckets" as stated in the main description
   - Reality: duplicates='drop' can create highly uneven buckets
   - The documentation creates a reasonable expectation that is violated

Conclusion: The documentation is incomplete and misleading. It promises "equal-sized
buckets" without qualifying that this property is violated when duplicates='drop' is
used. At minimum, the documentation should warn users about this behavior.