## Bug Reproduction Analysis

### Test Results

I successfully reproduced the reported bug. The test results confirm:

1. **Empty String Behavior**:
   - `_excel2num('')` returns `-1` (confirmed)
   - `_excel2num('   ')` returns `-1` (confirmed)
   - No `ValueError` is raised as the documentation states should happen

2. **Hypothesis Test**:
   - The provided hypothesis test runs and confirms the bug
   - Empty and whitespace-only strings return `-1` instead of raising `ValueError`

3. **Code Analysis**:
   The bug occurs exactly as described in the report. Looking at lines 117-127:
   - When `x.upper().strip()` is empty, the for loop never executes
   - `index` remains 0
   - The function returns `index - 1 = -1`

4. **Edge Cases Tested**:
   - Empty string: returns `-1`
   - Whitespace variations (space, tab, newline): all return `-1`
   - Invalid characters (numbers, special chars): correctly raise `ValueError`
   - Valid column names: work correctly (A=0, B=1, Z=25, AA=26, etc.)

5. **Impact on Other Functions**:
   Testing `_range2cols` which uses `_excel2num`:
   - `_range2cols('')` returns `[-1]`
   - `_range2cols('A,,C')` returns `[0, -1, 2]` (empty element becomes -1)
   - `_range2cols(':B')` returns `[-1, 0, 1]` (empty start becomes -1)

   This shows the bug can propagate to other functions, potentially causing:
   - Invalid column indices (-1) being used
   - Python's negative indexing accessing the last column unexpectedly
   - Silent failures in column range specifications

### Technical Verification

The bug report is technically accurate:
1. The function does return `-1` for empty/whitespace strings
2. The documentation states it should raise `ValueError` for invalid input
3. An empty string is not a valid Excel column name
4. The code behavior contradicts the documented behavior

### Comparison with Expected Behavior

**Current Behavior**: Empty string → returns `-1`
**Documented Behavior**: Invalid column name → raises `ValueError`
**Expected Behavior**: Empty string (invalid) → should raise `ValueError`

The bug report correctly identifies this discrepancy between documented and actual behavior.